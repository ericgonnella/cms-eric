<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header>
    <h1>Blog</h1>
    <p>Welcome to the blog! Here are the latest posts:</p>
  </header>
  <main id="blog-list"></main>
  <script>
    // Fetch blog posts dynamically
    async function fetchPosts() {
  const blogList = document.getElementById('blog-preview');
  const posts = [];

  // Fetch JSON files dynamically
  const response = await fetch('/content/blog');
  const directoryHTML = await response.text(); // Get the directory listing as HTML
  const parser = new DOMParser();
  const doc = parser.parseFromString(directoryHTML, 'text/html');
  const files = Array.from(doc.querySelectorAll('a')).filter(file => file.href.endsWith('.json'));

  // Load each JSON file
  for (const file of files) {
    const fileResponse = await fetch(file.href);
    const post = await fileResponse.json();
    posts.push(post);
  }

  // Render blog posts
  posts.forEach(post => {
    const article = document.createElement('article');
    article.innerHTML = `
      <h3>${post.title}</h3>
      <p><small>${new Date(post.date).toLocaleDateString()} by ${post.author}</small></p>
      <p>${post.body.substring(0, 100)}...</p>
      <a href="#">Read More</a>
    `;
    blogList.appendChild(article);
  });
}

fetchPosts().catch(err => console.error('Error fetching posts:', err));


    fetchPosts();
  </script>
</body>
</html>
