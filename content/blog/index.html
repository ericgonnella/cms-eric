<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header>
    <h1>All Blog Posts</h1>
    <nav>
      <a href="/">Home</a>
    </nav>
  </header>
  <main id="all-blogs">
    <!-- Blog list will be dynamically inserted here -->
  </main>

<script>

document.addEventListener("DOMContentLoaded", () => {
  async function loadAllBlogs() {
    const blogContainer = document.getElementById('all-blogs');

    // Check if the blogContainer element exists
    if (!blogContainer) {
      console.error('"all-blogs" element not found.');
      return;
    }

    try {
      const response = await fetch('/content/blog/index.json');
      const files = await response.json();

      blogContainer.innerHTML = '';

      for (const file of files) {
        const postResponse = await fetch(`/content/blog/${file}`);
        const post = await postResponse.json();

        // Validate fields before rendering
        if (!post.title || !post.body) {
          console.warn(`Skipping invalid post: ${file}`);
          continue;
        }

        const article = document.createElement('article');
        article.innerHTML = `
          <h2>${post.title}</h2>
          <p>${post.body.substring(0, 200)}...</p>
          <a href="/content/blog/${file.replace('.json', '.html')}" class="btn">Read More</a>
        `;
        blogContainer.appendChild(article);
      }
    } catch (error) {
      console.error('Error loading blog posts:', error);
      blogContainer.innerHTML = '<p>Could not load blog posts. Please try again later.</p>';
    }
  }

  loadAllBlogs();
});


</script>

  <script>
async function loadAllBlogs() {
  try {
    const response = await fetch('/content/blog/index.json');
    const files = await response.json();

    const blogContainer = document.getElementById('all-blogs');
    blogContainer.innerHTML = '';

    for (const file of files) {
      try {
        const postResponse = await fetch(`/content/blog/${file}`);
        const post = await postResponse.json();

        // Validate the post structure
        if (!post.title || !post.body) {
          console.warn(`Skipping invalid post: ${file}`, post);
          continue; // Skip this post
        }

        const article = document.createElement('article');
        article.innerHTML = `
          <h2>${post.title}</h2>
          <p>${post.body.substring(0, 200)}...</p>
          <a href="/content/blog/${file.replace('.json', '.html')}" class="btn">Read More</a>
        `;
        blogContainer.appendChild(article);
      } catch (postError) {
        console.error(`Error loading post ${file}:`, postError);
      }
    }
  } catch (error) {
    console.error('Error loading blog posts:', error);
    const blogContainer = document.getElementById('all-blogs');
    blogContainer.innerHTML = '<p>Could not load blog posts. Please try again later.</p>';
  }
}
  </script>


</body>
</html>
