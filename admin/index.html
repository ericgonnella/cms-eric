<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="/cms.css" /> -->
  <!-- <link rel="stylesheet" href="/global.css"> -->
  <title>Admin Dashboard</title>
</head>
<body>

  <!-- Load Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>

  <!-- Load Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <script>
    // Enable Netlify Identity debug mode
    window.netlifyIdentityDebug = true;

    // Initialize Netlify Identity
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", (user) => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });

          if (window.netlifyIdentity) {
  window.netlifyIdentity.on('login', () => {
    // Re-fetch blog posts after login/publish
    fetchBlogPosts();
  });
}
        }
      });
      window.netlifyIdentity.init(); // Ensure Identity is initialized
    }
  </script>


<script>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      if (!user) {
        console.log("No user logged in.");
      } else {
        console.log("Logged in as:", user);
      }
    });
    window.netlifyIdentity.on("login", () => {
      console.log("User logged in.");
      document.location.href = "/admin/";
    });
  }
</script>


</body>
</html>